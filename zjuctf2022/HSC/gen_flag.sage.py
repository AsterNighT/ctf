

# This file was *autogenerated* from the file gen_flag.sage
from sage.all_cmdline import *   # import sage library

_sage_const_4 = Integer(4); _sage_const_256 = Integer(256); _sage_const_3 = Integer(3)
from pwn import *


def test_flag(candidate):
    assert (len(candidate) == _sage_const_4 )
    known = ("AAA{"+candidate+"}")
    NT = matrix(Zmod(_sage_const_256 ), _sage_const_3 , _sage_const_3 )
    for i in range(_sage_const_3 ):
        for j in range(_sage_const_3 ):
            NT[i, j] = ord(known[i+j*_sage_const_3 ])
    if (not NT.is_invertible()):
        return False
    return True


alphabet = string.digits + string.ascii_letters + string.punctuation
pwnlib.util.iters.mbruteforce(test_flag, alphabet, _sage_const_4 , 'fixed')


